<ion-content>
    <div style="position: relative; height: 100%; width: 100%;">
        <agm-map style="height: 100vh" [latitude]="pedido.direccion.lat" [longitude]="pedido.direccion.lng" [disableDefaultUI]="true" [streetViewControl]="false" [zoomControl]="false" [fitBounds]="true">
            <agm-marker [agmFitBounds]="true" [iconUrl]='{"url": icon,"scaledSize": {"height": 75, "width": 50}}' [latitude]="pedido.direccion.lat" [longitude]="pedido.direccion.lng" [animation]="'DROP'"></agm-marker>
            <agm-marker [agmFitBounds]="true" *ngIf="choferReady" [iconUrl]='{"url": truck,"scaledSize": {"height": 75, "width": 50}}' [latitude]="chofer.lat" [longitude]="chofer.lng" [animation]="'DROP'"></agm-marker>
        </agm-map>
        <div class="arrow">
            <ion-button (click)="regresar(null)" fill="clear">
                <ion-icon slot="start" name="arrow-back"></ion-icon>
            </ion-button>
        </div>
        <div class="cuadro-tel" *ngIf="!telReady">
            <ion-item>
                <ion-label lines="none" style="text-align: center">
                    <h2 style="color: var(--ion-color-primary);">Teléfono de contacto</h2>
                    <p class="ion-text-wrap">Mientras esperas tu pedido, por favor dinos un teléfono de contacto</p>
                </ion-label>
            </ion-item>
            <ion-item lines="none">
                <ion-label>Tel:
                    <ion-text color="danger">*</ion-text>
                </ion-label>
                <ion-input (keyup.enter)="onEnter()" [(ngModel)]="tel" type="tel" placeholder="Sin espacios ej. 4581188913"></ion-input>
            </ion-item>
        </div>
        <div class="cuadro">
            <ng-container *ngIf="!choferReady; else repaTemplate">
                <ion-item lines="none">
                    <ion-spinner style="margin: auto" color="primary" name="bubbles"></ion-spinner>
                </ion-item>
                <ion-item lines="none" style="text-align: center">
                    <ion-label>
                        <h2>Asignando repartidor</h2>
                        <p class="ion-text-wrap">Por favor espere mientras encontramos el repartidor más cercano</p>
                    </ion-label>
                </ion-item>
            </ng-container>
            <ng-template #repaTemplate>
                <div style="width: 100%; height: 100%;">
                    <ion-item lines="none" style="margin-top: 1rem">
                        <ion-avatar slot="start">
                            <img [src]="chofer.foto" />
                        </ion-avatar>
                        <ion-label>
                            <h2>{{chofer.nombre}}</h2>
                        </ion-label>
                    </ion-item>
                    <ion-item lines="none">
                        <ion-button slot="end" fill="outline" (click)="llamar()">
                            <ion-icon style="margin-right: 0.5rem" name="call"></ion-icon> Llamar
                        </ion-button>
                        <ion-button slot="end" (click)="muestraChat()">
                            <ion-icon style="margin-right: 0.5rem" name="chatbubbles"></ion-icon> Chat
                        </ion-button>
                    </ion-item>
                </div>
            </ng-template>
        </div>
    </div>
</ion-content>